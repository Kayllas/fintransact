<div class="min-h-screen bg-gray-50">
    <div class="surface-overlay py-3 px-6 shadow-2 flex align-items-center justify-content-between relative lg:static">
        <div class="flex align-items-center">
            <span class="text-900 font-medium text-2xl mr-4">FinTransact</span>
            <span class="text-600 font-medium text-xl">Welcome, {{currentUser.name}}</span>
        </div>
        <a pButton pRipple label="Logout" icon="pi pi-sign-out" class="p-button-text" (click)="logout()"></a>
    </div>

    <div class="p-5">
        <div class="grid">
            <div class="col-12 md:col-6 lg:col-4">
                <p-card header="Balance" styleClass="shadow-2 h-full">
                    <div class="text-4xl font-bold text-primary">{{ account.balance | currency:'USD' }}</div>
                    <div class="text-500 mt-2">Account Number: {{ account.accountNumber }}</div>
                    <div class="mt-4">
                        <button pButton pRipple label="New Transfer" icon="pi pi-send"
                            (click)="showTransferDialog()"></button>
                    </div>
                </p-card>
            </div>
            <div class="col-12 md:col-6 lg:col-8">
                <p-card header="Recent Transactions" styleClass="shadow-2 h-full">
                    <p-table [value]="transactions" [rows]="5" [paginator]="true" responsiveLayout="scroll">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>Date</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Details</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-transaction>
                            <tr>
                                <td>{{ transaction.timestamp | date:'short' }}</td>
                                <td><span [class]="'customer-badge status-' + transaction.type">{{ transaction.type
                                        }}</span></td>
                                <td
                                    [ngClass]="{'text-green-500': transaction.type === 'DEPOSIT' || (transaction.type === 'TRANSFER' && transaction.targetAccount.id === account.id), 'text-red-500': transaction.type === 'WITHDRAW' || (transaction.type === 'TRANSFER' && transaction.sourceAccount.id === account.id)}">
                                    {{ transaction.amount | currency:'USD' }}
                                </td>
                                <td>
                                    <span *ngIf="transaction.type === 'TRANSFER'">
                                        {{ transaction.sourceAccount.id === account.id ? 'To: ' +
                                        transaction.targetAccount.user.name : 'From: ' +
                                        transaction.sourceAccount.user.name }}
                                    </span>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </p-card>
            </div>
        </div>
    </div>

    <p-dialog header="Transfer Money" [(visible)]="displayTransferDialog" [modal]="true" [style]="{width: '400px'}"
        [draggable]="false" [resizable]="false">
        <div class="field">
            <label for="targetAccount" class="block">Target Account Number</label>
            <input type="text" pInputText id="targetAccount" [(ngModel)]="transferForm.targetAccountNumber"
                class="w-full" />
        </div>
        <div class="field mt-3">
            <label for="amount" class="block">Amount</label>
            <input type="number" pInputText id="amount" [(ngModel)]="transferForm.amount" class="w-full" />
        </div>
        <ng-template pTemplate="footer">
            <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text"
                (click)="displayTransferDialog=false"></button>
            <button pButton pRipple label="Transfer" icon="pi pi-check" (click)="onTransfer()" autofocus></button>
        </ng-template>
    </p-dialog>

    <p-toast></p-toast>
</div>